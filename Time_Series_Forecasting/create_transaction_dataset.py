# -*- coding: utf-8 -*-
"""
Created on Wed May 29 11:35:24 2019

@author: SHARDUL
"""
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import random
from datetime import datetime, timedelta


min_year=2015
max_year=datetime.now().year
start = datetime(min_year, 1, 1, 00, 00, 00)
years = max_year - min_year+1
end = start + timedelta(days=365 * years)
ts=list()
for i in range(1000):
    random_date = start + (end - start) * random.random()
    ts.append(random_date)
def gen_datetime(min_year=2015, max_year=datetime.now().year):
    # generate a datetime in format yyyy-mm-dd hh:mm:ss.000000
    start = datetime(min_year, 1, 1, 00, 00, 00)
    years = max_year - min_year + 1
    end = start + timedelta(days=365 * years)
    return start + (end - start) * random.random()

df=pd.read_csv('trans_hist.csv')
df=df.drop(columns="Unnamed: 0.1")
df=df.drop(columns="Unnamed: 0")
df.to_csv('final_trans_hist.csv')

size=list()
for i in range(0,1000):
    rd=random.randint(50, 350)
    size.append(rd)
df['No_Of_Pages']=size




dataset1=pd.read_csv('transaction.csv')
client=list(dataset1['User'])
client.append("Aditya")
client.append("Avni")
dat=pd.read_csv('names.csv')
unq_rd=str("71751 35176 91787 21954 84569 96723 33703 49320 29026 89910 80701 81769 78565 88178 59338 45857 59743 18086 69615 41584 72560 79633 31858 15836 63902 19704 78855 48284 39998 17972 57493 38930 21176 47880 67770 34657 33994 09427 83128 35466 78451 02613 30126 94473 27990 00882 08763 58561 35726 30789 19040 54288 48543 92337 34398 81655 93000 85523 07954 14104 42539 83792 86591 04750 23717 13699 70310 00477 36535 75246 12227 01286 80992 41875 59224 60293 57088 66701 37862 24381 38266 96609 21581 20108 51084 58156 63497 47475 95541 24785 10495 79924 45080 49611 89132 44012 52816 79519 99409 39739 65633 41066 14767 67106 10090 07695 61765 26112 59629 32521 40403 90200 40807 62429 50679 85928 80183 23976 66038 13295 98082 90605 13036 45743 74178 15431 91673 09831 55356 45339 01950 05559 68174 06886 17308 32926 12631 73515 90864 91932 88728 98341 42943 56020 69906 28249 53220 51748 82723 89796 95137 79115 27180 56425 42134 11563 76719 81251 20772 75651 84455 11158 04491 71378 97273 46148 46407 98745 15172 39334 93405 31194 91268 37603 72042 21840 72447 94068 82319 17567 85264 29058 97677 18376 29721 22244 44675 77383 05818 20513 23312 41471 86996 76978 33589 37198 99814 11968 48948 64565 44271 05154 95946 97014 93809 03422 74583 87660 01545 33330 84860 83387 14363 94877 00218 84196 32262 88064 47216 43202 08359 86332 25853 07290 89537 16240 36130 03018 02354 77787 78046 30385 46811 70974 25044 62833 22908 69242 03682 26921 04086 99150 87400 22649 16904 60697 29317 50016 61361 53884 76315 09022 10899 52152 54952 73110 18635 82060 38671 68838 31453 43607 80587 96205 75910 36794 27585 28653 25449 35062 06222 92741 06627 64970 16499 88469 19444 26517 76656 92273 71979 32862 50212 51280 48075 57688 02291 15368 29253 87596 12568 11095 42071 49143 54484 38462 86528 15772 01482 70911 36067 40598 80119 34999 43803 70506 63838 30726 56620 05495 05754 58093 74519 98682 52752 90541 50616 96950 31390 81187 31794 53416 41666 76915 44612 88405 57025 77724 89069 81592 04023 36730 65165 79860 82660 00818 46343 36326 92937 96546 59161 71315 08295 23913 03618 64502 55293 56361 53157 62770 33930 47007 60893 92678 44207 42735 73710 54225 59566 43544 91610 47412 06563 02550 67706 45680 85201 66638 48884 75588 95478 62365 61702 37135 37394 89732 06159 30321 84392 22181 82255 28590 63029 86269 63434 58497 46748 81996 76251 20045 88664 09363 20708 13231 35662 68370 70247 11500 14299 32458 77983 41407 98018 28185 90801 02955 39935 55552 35258 96141 86933 88001 84796 94409 65570 52089 65974 24317 75847 47816 78792 85864 91205 75183 23249 79051 38203 07632 99346 77319 16840 98277 80524 07227 27117 94005 93341 68774 42475 94814 37798 61961 89473 53820 87337 60229 68111 17908 95073 90137 78387 13636 07891 51684 93746 41003 52348 44871 67302 73451 01886 43139 45939 64097 83065 73047 29658 59825 95882 34594 71574 60634 40339 01223 18572 19640 16436 26049 97209 83728 97614 55957 80928 79456 10431 17504 22845 06823 54889 84133 69842 39271 04427 08959 48480 03359 12163 38867 58757 99087")
unq_usr=np.unique(list(dataset1['User']))
usrs=list(dat['Owner'])
rid=unq_rd.split(' ')
own=pd.DataFrame()
own1=list()
repid=list()
cost=list()
own['Owner']=own1
own['Report_Id']=repid
own['Cost']=cost
own.to_csv('owner.csv')

trans=pd.DataFrame()
sendr=list()
rece=list()
earn=list()
time=list()
repid1=list()
for i in range(0,len(client)):
     rd=random.randrange(0, 500)
     sendr.append(own1[rd])
     rece.append(client[i])
     earn.append(cost[rd])
     repid1.append(repid[rd])
trans['Owner']=sendr
trans['Buyer']=rece
trans['Cost']=earn
trans['Report']=repid1
trans['Time']=ts
trans.to_csv("final_transactions.csv")

for i in range(0,998):
    i1=unq_usr[i]
    rd=random.randrange(0, 150)
    i1=str(i1+'-'+str(rd))
    rid.append(i1)